<div class="table-responsive pt-3">
 

  <table class="table table-bordered">
    <thead>
      <tr>
        <th>
          #
        </th>
        <th>
          image
        </th>
        <th>
          name
        </th>
        <th>
          Price
        </th>
        <th>
          Status
        </th>
        <th>
          Order Date and Time
        </th>
        <th>
          <!-- <button>btn</button> -->
        </th>


      </tr>
    </thead>

    <% let getDate=(data)=>{%>
      let OrderDate= new Date(data)

      let day=OrderDate.getDate();
      let month=OrderDate.getMonth();
      let year=OrderDate.getFullYear();

      return `${isNaN(day)?00:day}-${isNaN(month)?00:month}-${isNaN(year)?0000:year`
        <% } %> 
     


      <tbody>
        <% for(i=0;i<orders.length;i++){%>
          <% orders[i].productDetails.forEach((products,index)=>{%>
            <tr>
              <td>
                <%=index+1 %>
              </td>
              <td>
                <img style="border-radius:0;" src="/productimages/<%= products._id %>.jpg" alt="img">
              </td>
              <td>
                <%= products.productsName %>
              </td>
              <td>
                <%= products.productprice%>

              </td>
              <td>
              <% if(products.status){%>
                <span class="text-success">Order placed</span>
                  <% }else { %>
               
<span class="text-danger">Order cancelled</span>
                    <% } %> 
                
              </td>
              <td>
                <%= orders[i].createdAt %>
              </td>
              <td>
               <button class="btn btn-danger" onclick="cancelOrder('<%=orders[i]._id%>','<%=products._id%>')">
                           Cancel
               </button>
              </td>
            </tr>
            <% })%>
              <% }%>
      </tbody>
  </table>
</div>

<script >
 function cancelOrder(orderId,proId) {
        $.ajax({
            url: '/cancelOrder',
            data: {
                orderId:orderId,
                productId: proId
            },
            method: 'post',
            beforeSend: () => {
                return confirm('are you sure')
            },
            success:(response)=>{
                 window.location.reload()
            }

        })
    }
</script>